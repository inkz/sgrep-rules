rules:
  - id: attribute-read-from-multiple-sources
    patterns:
      - pattern-inside: |
          func $HANDLER(..., $R *http.Request, ...) {
            ...
          }
      - pattern: |
          $A = $X.$ATT
          ...
          $B = $Y.$ATT
    message: "Attribute $ATT is read from two different sources: '$X.$ATT' and '$Y.$ATT'. Make sure this is intended, as this could cause logic bugs if they are treated as if they are the same object."
    languages: [go]
    severity: WARNING 
  - id: attribute-read-from-multiple-sources-dict
    patterns:
      - pattern-inside: |
          func $HANDLER(..., $R *http.Request, ...) {
            ...
          }
      - pattern: |
          $A = $X[$KEY]
          ...
          $B = $Y.$ATT
      - pattern-where-python: "vars['$KEY'].strip('\"') == vars['$ATT']"
    message: "Attribute $ATT is read from two different sources: '$X[$KEY]' and '$Y.$ATT'. Make sure this is intended, as this could cause logic bugs if they are treated as if they are the same object."
    languages: [go]
    severity: WARNING 
